"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9023],{97245:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>o,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>t,toc:()=>l});var t=i(98041),s=i(74848),a=i(28453);const r={date:"2024-12-21 18:17",slug:"WordPress\u7ba1\u7406\u540e\u53f0\u8bbe\u7f6e\u91cc\u6dfb\u52a0\u7ef4\u62a4\u6a21\u5f0f\u5f00\u5173"},c=void 0,o={authorsImageUrls:[]},l=[{value:"\u5982\u679c\u5f00\u5173\u4e0d\u5f00\u542f\uff0c\u4ee3\u7801\u5c31\u4e0d\u5de5\u4f5c\uff0c\u4e0d\u4f1a\u5f71\u54cd\u6027\u80fd",id:"\u5982\u679c\u5f00\u5173\u4e0d\u5f00\u542f\u4ee3\u7801\u5c31\u4e0d\u5de5\u4f5c\u4e0d\u4f1a\u5f71\u54cd\u6027\u80fd",level:3}];function d(n){const e={code:"code",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u7ef4\u62a4\u6a21\u5f0f\u4e0b\u8fd4\u56de503\u72b6\u6001\u7801\uff0c\u5bf9SEO\u66f4\u53cb\u597d"}),"\n",(0,s.jsx)(e.li,{children:"\u7ba1\u7406\u5458\u53ef\u4ee5\u7ee7\u7eed\u6b63\u5e38\u8bbf\u95ee\u7ad9\u70b9"}),"\n",(0,s.jsx)(e.li,{children:"\u7b80\u5355\u7684\u5f00\u5173\u63a7\u5236"}),"\n",(0,s.jsx)(e.li,{children:'\u7ef4\u62a4\u6a21\u5f0f\u83dc\u5355\u79fb\u5230"\u8bbe\u7f6e"\u83dc\u5355\u4e0b'}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"\n\n// \u6dfb\u52a0\u7ef4\u62a4\u6a21\u5f0f\u529f\u80fd\nfunction csrwiki_maintenance_mode() {\n    // \u6dfb\u52a0\u8bbe\u7f6e\u83dc\u5355 - \u653e\u5230\"\u8bbe\u7f6e\"\u4e0b\n    add_action('admin_menu', function() {\n        add_options_page(\n            '\u7ef4\u62a4\u6a21\u5f0f\u8bbe\u7f6e', \n            '\u7ef4\u62a4\u6a21\u5f0f', \n            'manage_options', \n            'maintenance-settings', \n            'csrwiki_maintenance_settings_page'\n        );\n    });\n\n    // \u6ce8\u518c\u8bbe\u7f6e\n    add_action('admin_init', function() {\n        register_setting('maintenance-settings-group', 'maintenance_mode_active');\n    });\n\n    // \u5728wp\u52a0\u8f7d\u65e9\u671f\u68c0\u67e5\u7ef4\u62a4\u6a21\u5f0f\n    add_action('wp', 'csrwiki_check_maintenance_mode');\n}\n// \u68c0\u67e5\u7ef4\u62a4\u6a21\u5f0f\u72b6\u6001\nfunction csrwiki_check_maintenance_mode() {\n    // \u5982\u679c\u7ef4\u62a4\u6a21\u5f0f\u5df2\u542f\u7528\u4e14\u5f53\u524d\u7528\u6237\u4e0d\u662f\u7ba1\u7406\u5458\n    if (get_option('maintenance_mode_active') && !current_user_can('manage_options')) {\n        // \u786e\u4fdd\u4e0d\u662fwp-admin\u9875\u9762\n        if (!is_admin() && !wp_doing_ajax()) {\n            wp_die(\n                '<div style=\"text-align: center; padding: 50px 20px;\">\n                    <h1>\u7f51\u7ad9\u7ef4\u62a4\u4e2d</h1>\n                    <p>\u6211\u4eec\u6b63\u5728\u8fdb\u884c\u7cfb\u7edf\u7ef4\u62a4\uff0c\u8bf7\u7a0d\u540e\u518d\u8bbf\u95ee\u3002</p>\n                </div>',\n                '\u7f51\u7ad9\u7ef4\u62a4\u4e2d',\n                array(\n                    'response' => 503,\n                    'back_link' => false,\n                )\n            );\n        }\n    }\n}\n\n// \u8bbe\u7f6e\u9875\u9762HTML\nfunction csrwiki_maintenance_settings_page() {\n    ?>\n    <div class=\"wrap\">\n        <h1>\u7ef4\u62a4\u6a21\u5f0f\u8bbe\u7f6e</h1>\n        <form method=\"post\" action=\"options.php\">\n            <?php settings_fields('maintenance-settings-group'); ?>\n            <?php do_settings_sections('maintenance-settings-group'); ?>\n            <table class=\"form-table\">\n                <tr>\n                    <th scope=\"row\">\u7ef4\u62a4\u6a21\u5f0f\u72b6\u6001</th>\n                    <td>\n                        <label>\n                            <input type=\"checkbox\" name=\"maintenance_mode_active\" value=\"1\" <?php checked(1, get_option('maintenance_mode_active'), true); ?> />\n                            \u542f\u7528\u7ef4\u62a4\u6a21\u5f0f\n                        </label>\n                    </td>\n                </tr>\n            </table>\n            <?php submit_button(); ?>\n        </form>\n    </div>\n    <?php\n}\n\n// \u521d\u59cb\u5316\u7ef4\u62a4\u6a21\u5f0f\u529f\u80fd\ncsrwiki_maintenance_mode();\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u5982\u679c\u5f00\u5173\u4e0d\u5f00\u542f\u4ee3\u7801\u5c31\u4e0d\u5de5\u4f5c\u4e0d\u4f1a\u5f71\u54cd\u6027\u80fd",children:"\u5982\u679c\u5f00\u5173\u4e0d\u5f00\u542f\uff0c\u4ee3\u7801\u5c31\u4e0d\u5de5\u4f5c\uff0c\u4e0d\u4f1a\u5f71\u54cd\u6027\u80fd"}),"\n",(0,s.jsx)(e.p,{children:"\u662f\u7684\uff0c\u6027\u80fd\u5f71\u54cd\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1\u3002\u8ba9\u6211\u89e3\u91ca\u4ee3\u7801\u6267\u884c\u8fc7\u7a0b\uff1a"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u63d2\u4ef6\u6ce8\u518c\u4e86\u4e24\u4e2a\u4e3b\u8981\u884c\u4e3a\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"admin_menu hook\uff1a\u4ec5\u5728\u540e\u53f0\u8fd0\u884c\u65f6\u52a0\u8f7d"}),"\n",(0,s.jsx)(e.li,{children:"admin_init hook\uff1a\u4ec5\u5728\u540e\u53f0\u8fd0\u884c\u65f6\u52a0\u8f7d"}),"\n",(0,s.jsx)(e.li,{children:"wp hook\uff1a\u867d\u7136\u6bcf\u6b21\u90fd\u4f1a\u6267\u884c\uff0c\u4f46\u53ea\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u6761\u4ef6\u5224\u65ad"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u5177\u4f53\u5206\u6790\u7ef4\u62a4\u6a21\u5f0f\u5173\u95ed\u65f6\u7684\u6267\u884c\u6d41\u7a0b\uff1a"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",children:"function csrwiki_check_maintenance_mode() {\n    // \u5f53\u7ef4\u62a4\u6a21\u5f0f\u672a\u5f00\u542f\u65f6\uff0c\u8fd9\u4e2aif\u5224\u65ad\u76f4\u63a5\u8fd4\u56de\n    if (get_option('maintenance_mode_active') && !current_user_can('manage_options')) {\n        // \u7ef4\u62a4\u6a21\u5f0f\u5173\u95ed\u65f6\uff0c\u8fd9\u91cc\u9762\u7684\u4ee3\u7801\u5b8c\u5168\u4e0d\u4f1a\u6267\u884c\n    }\n}\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u6027\u80fd\u5f00\u9500\u6781\u5c0f\uff0c\u539f\u56e0\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"get_option() \u662fWordPress\u6838\u5fc3\u51fd\u6570\uff0c\u6709\u5185\u7f6e\u7f13\u5b58"}),"\n",(0,s.jsx)(e.li,{children:"\u6761\u4ef6\u5224\u65ad\u5931\u8d25\u540e\u7acb\u5373\u8fd4\u56de"}),"\n",(0,s.jsx)(e.li,{children:"\u6ca1\u6709\u989d\u5916\u7684\u6570\u636e\u5e93\u67e5\u8be2"}),"\n",(0,s.jsx)(e.li,{children:"\u6ca1\u6709\u989d\u5916\u7684\u6587\u4ef6\u52a0\u8f7d"}),"\n",(0,s.jsx)(e.li,{children:"\u4e0d\u4f1a\u6267\u884c\u4efb\u4f55DOM\u64cd\u4f5c"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u6240\u4ee5\u4f60\u5b8c\u5168\u4e0d\u7528\u62c5\u5fc3\u6027\u80fd\u95ee\u9898\u3002\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u8f7b\u91cf\u7ea7\u7684\u529f\u80fd\u5b9e\u73b0\u3002"})]})}function p(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},28453:(n,e,i)=>{i.d(e,{R:()=>r,x:()=>c});var t=i(96540);const s={},a=t.createContext(s);function r(n){const e=t.useContext(a);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:r(n.components),t.createElement(a.Provider,{value:e},n.children)}},98041:n=>{n.exports=JSON.parse('{"permalink":"/blog/WordPress\u7ba1\u7406\u540e\u53f0\u8bbe\u7f6e\u91cc\u6dfb\u52a0\u7ef4\u62a4\u6a21\u5f0f\u5f00\u5173","editUrl":"https://github.com/frankelinli/frankelinli.github.io/edit/main/blog/2024/12-21-WordPress\u7ba1\u7406\u540e\u53f0\u8bbe\u7f6e\u91cc\u6dfb\u52a0\u7ef4\u62a4\u6a21\u5f0f\u5f00\u5173.md","source":"@site/blog/2024/12-21-WordPress\u7ba1\u7406\u540e\u53f0\u8bbe\u7f6e\u91cc\u6dfb\u52a0\u7ef4\u62a4\u6a21\u5f0f\u5f00\u5173.md","title":"WordPress\u7ba1\u7406\u540e\u53f0\u8bbe\u7f6e\u91cc\u6dfb\u52a0\u7ef4\u62a4\u6a21\u5f0f\u5f00\u5173","description":"- \u7ef4\u62a4\u6a21\u5f0f\u4e0b\u8fd4\u56de503\u72b6\u6001\u7801\uff0c\u5bf9SEO\u66f4\u53cb\u597d","date":"2024-12-21T18:17:00.000Z","tags":[],"readingTime":2.78,"hasTruncateMarker":true,"authors":[],"frontMatter":{"date":"2024-12-21 18:17","slug":"WordPress\u7ba1\u7406\u540e\u53f0\u8bbe\u7f6e\u91cc\u6dfb\u52a0\u7ef4\u62a4\u6a21\u5f0f\u5f00\u5173"},"unlisted":false,"lastUpdatedAt":1734789818000,"prevItem":{"title":"astra header\u9875\u7709\u4e0b\u5212\u7ebf\u52a8\u753b","permalink":"/blog/astra header\u9875\u7709\u4e0b\u5212\u7ebf\u52a8\u753b"},"nextItem":{"title":"\u6587\u7ae0\u7f16\u8f91\u540e\u53f0\u4e3a\u67d0\u4e2a\u5757\u8bbe\u7f6e\u4ec5\u7ba1\u7406\u5458\u53ef\u89c1","permalink":"/blog/\u6587\u7ae0\u7f16\u8f91\u540e\u53f0\u4e3a\u67d0\u4e2a\u5757\u8bbe\u7f6e\u4ec5\u7ba1\u7406\u5458\u53ef\u89c1"}}')}}]);