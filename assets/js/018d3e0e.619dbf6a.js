"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3479],{185:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>l});var r=t(4848),i=t(8453);const s={date:"2024-06-20 23:03",slug:"WordPress\u83b7\u53d6\u7528\u6237\u90ae\u7bb1\u7ed9\u4ed6\u53d1\u90ae\u4ef6"},o=void 0,a={permalink:"/blog/WordPress\u83b7\u53d6\u7528\u6237\u90ae\u7bb1\u7ed9\u4ed6\u53d1\u90ae\u4ef6",editUrl:"https://github.com/frankelinli/frankelinli.github.io/edit/main/blog/2024/06-20-WordPress\u83b7\u53d6\u7528\u6237\u90ae\u7bb1\u7ed9\u4ed6\u53d1\u90ae\u4ef6.md",source:"@site/blog/2024/06-20-WordPress\u83b7\u53d6\u7528\u6237\u90ae\u7bb1\u7ed9\u4ed6\u53d1\u90ae\u4ef6.md",title:"WordPress\u83b7\u53d6\u7528\u6237\u90ae\u7bb1\u7ed9\u4ed6\u53d1\u90ae\u4ef6",description:"\u5728\u8fd9\u4e2a\u535a\u5ba2\u91cc\uff0c\u6211\u4eec\u5c06\u63a2\u8ba8\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684WordPress\u529f\u80fd\uff0c\u5b83\u901a\u8fc7\u8ffd\u8e2a\u8bbf\u5ba2\u884c\u4e3a\u548c\u663e\u793a\u8bbf\u5ba2\u4fe1\u606f\u6765\u63d0\u5347\u7528\u6237\u4f53\u9a8c\u3002",date:"2024-06-20T23:03:00.000Z",tags:[],readingTime:2.45,hasTruncateMarker:!0,authors:[],frontMatter:{date:"2024-06-20 23:03",slug:"WordPress\u83b7\u53d6\u7528\u6237\u90ae\u7bb1\u7ed9\u4ed6\u53d1\u90ae\u4ef6"},unlisted:!1,lastUpdatedAt:171891043e4,prevItem:{title:"docusaurus\u9875\u9762\u8c03\u7528WordPress\u6587\u7ae0",permalink:"/blog/docusaurus\u9875\u9762\u8c03\u7528WordPress\u6587\u7ae0"},nextItem:{title:"WordPress\u663e\u793a\u8bbf\u5ba2IP\u548c\u64cd\u4f5c\u7cfb\u7edf\u7b49\u4fe1\u606f",permalink:"/blog/WordPress\u663e\u793a\u8bbf\u5ba2IP\u548c\u64cd\u4f5c\u7cfb\u7edf\u7b49\u4fe1\u606f"}},c={authorsImageUrls:[]},l=[{value:"\u8bbf\u5ba2\u7b2c4\u6b21\u8bbf\u95ee\u65f6\u63d0\u793a\u8f93\u5165\u90ae\u7bb1",id:"\u8bbf\u5ba2\u7b2c4\u6b21\u8bbf\u95ee\u65f6\u63d0\u793a\u8f93\u5165\u90ae\u7bb1",level:3},{value:"\u5b9e\u73b0\u4ee3\u7801\uff0c \u5b9e\u6d4b\u53ef\u7528\uff1b",id:"\u5b9e\u73b0\u4ee3\u7801-\u5b9e\u6d4b\u53ef\u7528",level:4}];function d(e){const n={code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"\u5728\u8fd9\u4e2a\u535a\u5ba2\u91cc\uff0c\u6211\u4eec\u5c06\u63a2\u8ba8\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684WordPress\u529f\u80fd\uff0c\u5b83\u901a\u8fc7\u8ffd\u8e2a\u8bbf\u5ba2\u884c\u4e3a\u548c\u663e\u793a\u8bbf\u5ba2\u4fe1\u606f\u6765\u63d0\u5347\u7528\u6237\u4f53\u9a8c\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"\u8bbf\u5ba2\u7b2c4\u6b21\u8bbf\u95ee\u65f6\u63d0\u793a\u8f93\u5165\u90ae\u7bb1",children:"\u8bbf\u5ba2\u7b2c4\u6b21\u8bbf\u95ee\u65f6\u63d0\u793a\u8f93\u5165\u90ae\u7bb1"}),"\n",(0,r.jsx)(n.p,{children:"\u6211\u4eec\u5e0c\u671b\u5728\u8bbf\u5ba2\u7b2c4\u6b21\u8bbf\u95ee\u9875\u9762\u65f6\uff0c\u63d0\u793a\u4ed6\u4eec\u8f93\u5165\u90ae\u7bb1\u5730\u5740\uff0c\u4ee5\u4fbf\u53d1\u9001\u901a\u77e5\u90ae\u4ef6\u3002\u5177\u4f53\u6b65\u9aa4\u5982\u4e0b\uff1a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u8bb0\u5f55\u8bbf\u5ba2\u8bbf\u95ee\u6b21\u6570\uff1a"})," \u4f7f\u7528\u6d4f\u89c8\u5668\u7684Cookie\u6765\u8bb0\u5f55\u8bbf\u5ba2\u7684\u8bbf\u95ee\u6b21\u6570\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u5f39\u51fa\u90ae\u7bb1\u8f93\u5165\u6846\uff1a"})," \u5f53\u8bbf\u95ee\u6b21\u6570\u8fbe\u52304\u6b21\u65f6\uff0c\u5f39\u51fa\u4e00\u4e2a\u63d0\u793a\u6846\u8981\u6c42\u7528\u6237\u8f93\u5165\u90ae\u7bb1\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u53d1\u9001\u90ae\u4ef6\uff1a"})," \u901a\u8fc7AJAX\u8bf7\u6c42\u5c06\u90ae\u7bb1\u5730\u5740\u53d1\u9001\u5230\u670d\u52a1\u5668\uff0c\u5e76\u7531\u670d\u52a1\u5668\u53d1\u9001\u4e00\u5c01\u786e\u8ba4\u90ae\u4ef6\u7ed9\u8bbf\u5ba2\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"\u5b9e\u73b0\u4ee3\u7801-\u5b9e\u6d4b\u53ef\u7528",children:"\u5b9e\u73b0\u4ee3\u7801\uff0c \u5b9e\u6d4b\u53ef\u7528\uff1b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"function csrwiki_fourth_visit_popup() {\n    ?>\n    <script type=\"text/javascript\">\n        document.addEventListener(\"DOMContentLoaded\", function() {\n            var visitCount = getCookie('csrwiki_visit_count');\n            visitCount = visitCount ? parseInt(visitCount) : 0;\n            visitCount++;\n            setCookie('csrwiki_visit_count', visitCount, 365);\n\n            if (visitCount === 4) {\n                var email = prompt(\"\u60a8\u5df2\u7ecf\u6d4f\u89c8\u4e86\u56db\u6b21\u3002\u8bf7\u8f93\u5165\u60a8\u7684\u90ae\u7bb1\u5730\u5740\u4ee5\u63a5\u6536\u901a\u77e5\uff1a\");\n                if (email) {\n                    var currentUrl = window.location.href;\n                    \n                    // \u53d1\u9001AJAX\u8bf7\u6c42\u5230\u670d\u52a1\u5668\n                    var xhr = new XMLHttpRequest();\n                    xhr.open(\"POST\", \"<?php echo admin_url('admin-ajax.php'); ?>\", true);\n                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n                    xhr.onreadystatechange = function () {\n                        if (xhr.readyState === 4 && xhr.status === 200) {\n                            alert(\"\u90ae\u4ef6\u5df2\u53d1\u9001\u5230\u60a8\u7684\u90ae\u7bb1\uff01\");\n                        }\n                    };\n                    xhr.send(\"action=send_email&email=\" + encodeURIComponent(email) + \"&url=\" + encodeURIComponent(currentUrl));\n                }\n            }\n        });\n\n        function setCookie(name, value, days) {\n            var expires = \"\";\n            if (days) {\n                var date = new Date();\n                date.setTime(date.getTime() + (days*24*60*60*1000));\n                expires = \"; expires=\" + date.toUTCString();\n            }\n            document.cookie = name + \"=\" + (value || \"\")  + expires + \"; path=/\";\n        }\n\n        function getCookie(name) {\n            var nameEQ = name + \"=\";\n            var ca = document.cookie.split(';');\n            for(var i=0;i < ca.length;i++) {\n                var c = ca[i];\n                while (c.charAt(0)==' ') c = c.substring(1,c.length);\n                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n            }\n            return null;\n        }\n    <\/script>\n    <?php\n}\nadd_action('wp_footer', 'csrwiki_fourth_visit_popup');\n\nfunction csrwiki_send_email() {\n    if (isset($_POST['email']) && is_email($_POST['email']) && isset($_POST['url'])) {\n        $to = sanitize_email($_POST['email']);\n        $url = esc_url_raw($_POST['url']);\n        $subject = \"\u611f\u8c22\u60a8\u7684\u8bbf\u95ee\";\n        $message = \"\u611f\u8c22\u60a8\u591a\u6b21\u8bbf\u95ee\u6211\u4eec\u7684\u7f51\u7ad9\uff01\u60a8\u6b63\u5728\u6d4f\u89c8\u7684\u9875\u9762\u662f\uff1a<a href=\\\"$url\\\">$url</a>\";\n        $headers = ['Content-Type: text/html; charset=UTF-8'];\n\n        wp_mail($to, $subject, $message, $headers);\n\n        wp_send_json_success('\u90ae\u4ef6\u5df2\u53d1\u9001');\n    } else {\n        wp_send_json_error('\u65e0\u6548\u7684\u90ae\u7bb1\u5730\u5740\u6216\u7f51\u5740');\n    }\n}\nadd_action('wp_ajax_send_email', 'csrwiki_send_email');\nadd_action('wp_ajax_nopriv_send_email', 'csrwiki_send_email');\n"})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var r=t(6540);const i={},s=r.createContext(i);function o(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);