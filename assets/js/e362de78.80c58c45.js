"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2743],{7956:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>a,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>l});var o=e(4848),c=e(8453);const i={},s=void 0,r={id:"astra hook\u5b9e\u73b0\u6587\u7ae0\u98753\u5217\u5e03\u5c40",title:"astra hook\u5b9e\u73b0\u6587\u7ae0\u98753\u5217\u5e03\u5c40",description:"\u7528Astra hook\u94a9\u5b50\u51fd\u6570\u6ce8\u5165\u5185\u5bb9",source:"@site/docs/wordpress-astra-theme/astra hook\u5b9e\u73b0\u6587\u7ae0\u98753\u5217\u5e03\u5c40.md",sourceDirName:".",slug:"/astra hook\u5b9e\u73b0\u6587\u7ae0\u98753\u5217\u5e03\u5c40",permalink:"/wordpress-astra-theme/astra hook\u5b9e\u73b0\u6587\u7ae0\u98753\u5217\u5e03\u5c40",draft:!1,unlisted:!1,editUrl:"https://github.com/frankelinli/frankelinli.github.io/edit/main/docs/wordpress-astra-theme/astra hook\u5b9e\u73b0\u6587\u7ae0\u98753\u5217\u5e03\u5c40.md",tags:[],version:"current",lastUpdatedAt:1722579845e3,frontMatter:{},sidebar:"zidongSidebar",next:{title:"index",permalink:"/wordpress-astra-theme/"}},a={},l=[{value:"\u7528Astra hook\u94a9\u5b50\u51fd\u6570\u6ce8\u5165\u5185\u5bb9",id:"\u7528astra-hook\u94a9\u5b50\u51fd\u6570\u6ce8\u5165\u5185\u5bb9",level:2},{value:"\u5f15\u5165tocbot\u5916\u90e8\u5e93\uff0c\u5b9e\u73b0\u53f3\u8fb9\u76ee\u5f55",id:"\u5f15\u5165tocbot\u5916\u90e8\u5e93\u5b9e\u73b0\u53f3\u8fb9\u76ee\u5f55",level:2},{value:"custome-toc.js",id:"custome-tocjs",level:2},{value:"CSS\u63a7\u5236hook\u6ce8\u5165\u7684\u5185\u5bb9\uff0c\u5b9e\u73b0\u53f3\u8fb9\u680f\uff1b",id:"css\u63a7\u5236hook\u6ce8\u5165\u7684\u5185\u5bb9\u5b9e\u73b0\u53f3\u8fb9\u680f",level:2}];function d(n){const t={admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",...(0,c.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"\u7528astra-hook\u94a9\u5b50\u51fd\u6570\u6ce8\u5165\u5185\u5bb9",children:"\u7528Astra hook\u94a9\u5b50\u51fd\u6570\u6ce8\u5165\u5185\u5bb9"}),"\n",(0,o.jsx)(t.p,{children:"functions.php\u91cc\u5982\u4e0b\uff1a"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"//\u4f7f\u7528astra_primary_content_bottom\u8fd9\u4e2ahook\u5f80\u5355\u9875\u535a\u5ba2\u91cc\u6ce8\u5165\u53f3\u8fb9\u680f\u5143\u7d20\nfunction add_custom_right_content() {\n    if (is_single()) {\n        echo '</div>';//\u91cd\u8981\uff01\u52a1\u5fc5\u8981\u6709\uff0c\u5173\u95edprimary\u7684\u6807\u7b7e\uff1b\n    echo '<div class=\"custom-right-content\">';\n    echo '<div class=\"widget-content toc-widget\">';\n    echo '<h3 class=\"widget-title\">\u76ee\u5f55<button class=\"toc-toggle\">\u2630</button></h3>';\n    echo '<nav class=\"toc-content\" id=\"toc\"></nav>';\n    echo '</div>'; // .widget-content\n    echo '</div>'; // .custom-right-content\n    }\n}\nadd_action('astra_primary_content_bottom', 'add_custom_right_content', 5);\n"})}),"\n",(0,o.jsx)(t.admonition,{title:"\u8b66\u544a",type:"warning",children:(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"echo '</div>';"}),"  \u91cd\u8981\uff01\u52a1\u5fc5\u8981\u6709\uff0c\u5173\u95edprimary\u7684\u6807\u7b7e\uff1b\u5426\u5219\u9875\u9762\u5e03\u5c40\u5931\u8d25\uff1b"]})}),"\n",(0,o.jsx)(t.h2,{id:"\u5f15\u5165tocbot\u5916\u90e8\u5e93\u5b9e\u73b0\u53f3\u8fb9\u76ee\u5f55",children:"\u5f15\u5165tocbot\u5916\u90e8\u5e93\uff0c\u5b9e\u73b0\u53f3\u8fb9\u76ee\u5f55"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"\nfunction enqueue_toc_scripts() {\n    wp_enqueue_script('tocbot', 'https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js', array(), '4.11.1', true);\n    wp_enqueue_style('tocbot-style', 'https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.css', array(), '4.11.1');\n    wp_enqueue_script('custom-toc', get_stylesheet_directory_uri() . '/custom-toc.js', array('tocbot'), '1.0', true);\n}\nadd_action('wp_enqueue_scripts', 'enqueue_toc_scripts');\n\n//tocbot\u4f7f\u7528\uff0c\u7ed9\u6bcf\u4e2a\u6807\u9898\u81ea\u52a8\u751f\u6210\u4e0e\u6807\u9898\u6587\u5b57\u4e00\u6837\u7684id\nfunction add_ids_to_headings($content) {\n    $pattern = '/<h([1-6])(.*?)>(.*?)<\\/h[1-6]>/i';\n    $content = preg_replace_callback($pattern, function($matches) {\n        $level = $matches[1];\n        $attrs = $matches[2];\n        $title = $matches[3];\n        $id = sanitize_title($title);\n        return \"<h$level$attrs id=\\\"$id\\\">$title</h$level>\";\n    }, $content);\n    return $content;\n}\nadd_filter('the_content', 'add_ids_to_headings');\n"})}),"\n",(0,o.jsx)(t.h2,{id:"custome-tocjs",children:"custome-toc.js"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"document.addEventListener('DOMContentLoaded', function() {\n    tocbot.init({\n        // Where to render the table of contents.\n        tocSelector: '.toc-content',\n        // Where to grab the headings to build the table of contents.\n        contentSelector: '.entry-content',\n        // Which headings to grab inside of the contentSelector element.\n        headingSelector: 'h2, h3, h4, h5, h6',\n        // For headings inside relative or absolute positioned containers within content.\n        hasInnerContainers: true,\n        // Smooth scroll options\n        scrollSmooth: false,\n        // scrollSmoothOffset: ,\n        // \u786e\u4fdd\u751f\u6210\u94fe\u63a5\n        linkClass: 'toc-link',\n        extraLinkClasses: '',\n        activeLinkClass: 'is-active-link',\n        listClass: 'toc-list',\n        extraListClasses: '',\n        isCollapsedClass: 'is-collapsed',\n        collapsibleClass: 'is-collapsible',\n        listItemClass: 'toc-list-item',\n        // \u65b0\u589e\uff1a\u81ea\u5b9a\u4e49 ID \u751f\u6210\n        headingsOffset: 40,\n        scrollSmoothDuration: 300,\n        orderedList: false,\n        collapseDepth: 6,\n        headingObjectCallback: function(object, element) {\n            // \u4f7f\u7528\u6807\u9898\u6587\u672c\u751f\u6210 ID\n            if (!element.id) {\n                element.id = element.textContent.trim().toLowerCase().replace(/\\s+/g, '-').replace(/[^\\w-]+/g, '');\n            }\n            return object;\n        },    \n               \n        \n    });\n\n    const tocToggle = document.querySelector('.toc-toggle');\n    const tocContent = document.querySelector('.toc-content');\n\n    if (tocToggle && tocContent) {\n        tocToggle.addEventListener('click', function() {\n            tocContent.classList.toggle('active');\n        });\n    }\n\n    // \u5982\u679c TOC \u4e3a\u7a7a\uff0c\u663e\u793a\u4e00\u6761\u6d88\u606f\n    if (tocContent && tocContent.children.length === 0) {\n        tocContent.innerHTML = '';\n    }\n});\n"})}),"\n",(0,o.jsx)(t.h2,{id:"css\u63a7\u5236hook\u6ce8\u5165\u7684\u5185\u5bb9\u5b9e\u73b0\u53f3\u8fb9\u680f",children:"CSS\u63a7\u5236hook\u6ce8\u5165\u7684\u5185\u5bb9\uff0c\u5b9e\u73b0\u53f3\u8fb9\u680f\uff1b"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-css",children:"\n.entry-content h1,\n.entry-content h2,\n.entry-content h3,\n.entry-content h4,\n.entry-content h5,\n.entry-content h6 {\n    margin-top: 0px; \n}\n\n.ast-container {\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: space-between;\n}\n\n#secondary.widget-area {\n    flex: 0 0 20%;\n    max-width: 20%;\n    order: 1;\n    padding: 64px 0 0 0;\n    margin-top: 0px;\n    \n}\n\n#primary.content-area {\n    flex: 0 0 55%;\n    max-width: 55%;\n    order: 2;\n}\n\n.custom-right-content {\n    flex: 0 0 25%;\n    max-width: 25%;\n    order: 3;\n    padding: 64px 0px 0px 0px;\n    box-sizing: border-box;\n}\n\n.toc-widget {\n    background-color: #f9f9f9;\n    border-left: 1px solid #e0e0e0;\n    border-radius: 5px;\n    padding: 15px;\n    position: sticky;\n    top: 20px;\n    max-height: calc(100vh - 80px);\n    overflow: hidden;\n    display: flex;\n    flex-direction: column;\n}\n\n.widget-title {\n    margin-top: 0;\n    display: flex;\n    justify-content: flex-start;\n\n   \n}\n\n.toc-toggle {\n    display: none;\n    background: none;\n    border: none;\n    font-size: 1.2em;\n    cursor: pointer;\n}\n\n.toc-content {\n    overflow-y: auto;\n    flex-grow: 1;\n}\n\n Tocbot \u81ea\u5b9a\u4e49\u6837\u5f0f \n.toc-list {\n    padding-left: 20px;\n    list-style-type: none;\n}\n\n.toc-list-item {\n    margin-bottom: 5px;\n}\n\n.toc-link {\n    cursor: pointer;\n    color: #333;\n    text-decoration: none;\n}\n\n.toc-link:hover {\n    text-decoration: underline;\n}\n\n.is-active-link {\n    font-weight: 700;\n}\n\n@media (max-width: 921px) {\n    #secondary.widget-area,\n    #primary.content-area,\n    .custom-right-content {\n        flex: 0 0 100%;\n        max-width: 100%;\n        padding-left: 0;\n        padding-right: 0;\n    }\n\n    #secondary.widget-area {\n        order: 3;\n    }\n\n    #primary.content-area {\n        order: 2;\n    }\n\n    .custom-right-content {\n        order: 1;\n    }\n\n    .toc-widget {\n        position: static;\n        max-height: none;\n        overflow: visible;\n    }\n\n    .toc-toggle {\n        display: block;\n    }\n\n    .toc-content {\n        display: none;\n        max-height: none;\n        overflow: visible;\n    }\n\n    .toc-content.active {\n        display: block;\n    }\n}\n"})})]})}function h(n={}){const{wrapper:t}={...(0,c.R)(),...n.components};return t?(0,o.jsx)(t,{...n,children:(0,o.jsx)(d,{...n})}):d(n)}},8453:(n,t,e)=>{e.d(t,{R:()=>s,x:()=>r});var o=e(6540);const c={},i=o.createContext(c);function s(n){const t=o.useContext(i);return o.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function r(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:s(n.components),o.createElement(i.Provider,{value:t},n.children)}}}]);