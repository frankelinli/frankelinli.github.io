---
date: 2024-06-20 12:15
slug: github action增量部署
---

我看到github gh-pages分支（build后的存放目录）里的文件日期，有的图片是几个月之前的，有的是刚刚的。

在 GitHub Pages 部署过程中，出现文件日期不一致的情况通常是因为增量部署机制。这意味着只有变化的文件会被更新，而没有变化的文件则保持不变。这可以节省时间和带宽，但可能会导致文件的时间戳看起来有些混乱。

以下是几个可能的原因和解释：

<!-- truncate -->

1. **增量更新**:
   - 在每次部署过程中，构建工具（如 Docusaurus）只会更新那些在当前构建中发生变化的文件。那些没有变化的文件将保留原来的时间戳。
   - 例如，如果某个图片文件在几个月前生成并且在之后的构建中没有变化，它的时间戳将保持原样。
2. **缓存机制**:
   - 部署过程中可能使用了缓存（如在 GitHub Actions 中使用 `actions/cache`），这可以加速构建和部署过程，同时也会保留未变化文件的时间戳。
3. **构建工具的优化**:
   - 有些构建工具会自动检测哪些文件需要更新，从而避免不必要的文件写入和上传。这可以提高效率，但也会导致文件时间戳的不一致。

### 解释文件日期差异的示例

假设你有一个网站项目，包含以下文件：

- `index.html`
- `style.css`
- `logo.png`
- `about.html`

在某次构建和部署中，你只修改了 `index.html` 和 `style.css`，而 `logo.png` 和 `about.html` 没有任何变化。结果如下：

- `index.html` 和 `style.css` 的时间戳会被更新为最新的构建和部署时间。
- `logo.png` 和 `about.html` 的时间戳会保持原样，因为它们没有变化，也没有被重新部署。
